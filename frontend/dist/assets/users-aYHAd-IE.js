import{g as J,a as K,d as Q,u as W,c as X}from"./system-DoQ-IRuu.js";import{_ as Y,p as Z,c as U,b as e,w as o,r as s,g as ee,h as m,q as le,o as p,j as ae,i as f,f as i,t as C,a as x,l as D,F as te,s as oe,n as se,E as w}from"./index-BxG9Idjn.js";const ne={class:"users-page"},de={class:"card-header"},re={__name:"users",setup(ie){const b=m(!1),v=m(!1),u=m(!1),V=m([]),y=m([]),k=m(null),t=ee({id:null,username:"",password:"",nickname:"",email:"",phone:"",status:1,role_ids:[]}),h={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},B=n=>n?new Date(n).toLocaleString("zh-CN"):"-",g=async()=>{b.value=!0;try{V.value=await J()}finally{b.value=!1}},E=async()=>{try{y.value=await K()}catch(n){console.error(n)}},N=()=>{Object.assign(t,{id:null,username:"",password:"",nickname:"",email:"",phone:"",status:1,role_ids:[]})},R=()=>{N(),u.value=!0},F=n=>{Object.assign(t,{...n,password:"",role_ids:[]}),u.value=!0},L=async()=>{if(await k.value.validate().catch(()=>!1)){v.value=!0;try{t.id?(await W(t.id,t),w.success("更新成功")):(await X(t),w.success("创建成功")),u.value=!1,g()}finally{v.value=!1}}},j=n=>{se.confirm("确定要删除该用户吗？","提示",{type:"warning"}).then(async()=>{await Q(n.id),w.success("删除成功"),g()}).catch(()=>{})};return Z(()=>{g(),E()}),(n,l)=>{const q=s("Plus"),M=s("el-icon"),c=s("el-button"),d=s("el-table-column"),S=s("el-tag"),$=s("el-table"),I=s("el-card"),_=s("el-input"),r=s("el-form-item"),O=s("el-option"),P=s("el-select"),z=s("el-switch"),A=s("el-form"),T=s("el-dialog"),G=le("loading");return p(),U("div",ne,[e(I,null,{header:o(()=>[x("div",de,[l[10]||(l[10]=x("span",null,"用户管理",-1)),e(c,{type:"primary",onClick:R},{default:o(()=>[e(M,null,{default:o(()=>[e(q)]),_:1}),l[9]||(l[9]=i(" 新增用户 ",-1))]),_:1})])]),default:o(()=>[ae((p(),f($,{data:V.value,stripe:"",border:""},{default:o(()=>[e(d,{prop:"id",label:"ID",width:"80"}),e(d,{prop:"username",label:"用户名",width:"120"}),e(d,{prop:"nickname",label:"昵称",width:"120"}),e(d,{prop:"email",label:"邮箱","min-width":"180"}),e(d,{prop:"phone",label:"手机号",width:"130"}),e(d,{prop:"status",label:"状态",width:"80",align:"center"},{default:o(({row:a})=>[e(S,{type:a.status===1?"success":"danger"},{default:o(()=>[i(C(a.status===1?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),e(d,{prop:"create_time",label:"创建时间",width:"170"},{default:o(({row:a})=>[i(C(B(a.create_time)),1)]),_:1}),e(d,{label:"操作",width:"150",fixed:"right"},{default:o(({row:a})=>[e(c,{type:"primary",link:"",onClick:H=>F(a)},{default:o(()=>[...l[11]||(l[11]=[i("编辑",-1)])]),_:1},8,["onClick"]),e(c,{type:"danger",link:"",onClick:H=>j(a),disabled:a.username==="admin"},{default:o(()=>[...l[12]||(l[12]=[i("删除",-1)])]),_:1},8,["onClick","disabled"])]),_:1})]),_:1},8,["data"])),[[G,b.value]])]),_:1}),e(T,{modelValue:u.value,"onUpdate:modelValue":l[8]||(l[8]=a=>u.value=a),title:t.id?"编辑用户":"新增用户",width:"500px"},{footer:o(()=>[e(c,{onClick:l[7]||(l[7]=a=>u.value=!1)},{default:o(()=>[...l[13]||(l[13]=[i("取消",-1)])]),_:1}),e(c,{type:"primary",loading:v.value,onClick:L},{default:o(()=>[...l[14]||(l[14]=[i("确定",-1)])]),_:1},8,["loading"])]),default:o(()=>[e(A,{ref_key:"formRef",ref:k,model:t,rules:h,"label-width":"80px"},{default:o(()=>[e(r,{label:"用户名",prop:"username"},{default:o(()=>[e(_,{modelValue:t.username,"onUpdate:modelValue":l[0]||(l[0]=a=>t.username=a),disabled:!!t.id},null,8,["modelValue","disabled"])]),_:1}),t.id?D("",!0):(p(),f(r,{key:0,label:"密码",prop:"password"},{default:o(()=>[e(_,{modelValue:t.password,"onUpdate:modelValue":l[1]||(l[1]=a=>t.password=a),type:"password","show-password":""},null,8,["modelValue"])]),_:1})),e(r,{label:"昵称",prop:"nickname"},{default:o(()=>[e(_,{modelValue:t.nickname,"onUpdate:modelValue":l[2]||(l[2]=a=>t.nickname=a)},null,8,["modelValue"])]),_:1}),e(r,{label:"邮箱",prop:"email"},{default:o(()=>[e(_,{modelValue:t.email,"onUpdate:modelValue":l[3]||(l[3]=a=>t.email=a)},null,8,["modelValue"])]),_:1}),e(r,{label:"手机号",prop:"phone"},{default:o(()=>[e(_,{modelValue:t.phone,"onUpdate:modelValue":l[4]||(l[4]=a=>t.phone=a)},null,8,["modelValue"])]),_:1}),e(r,{label:"角色",prop:"role_ids"},{default:o(()=>[e(P,{modelValue:t.role_ids,"onUpdate:modelValue":l[5]||(l[5]=a=>t.role_ids=a),multiple:"",style:{width:"100%"}},{default:o(()=>[(p(!0),U(te,null,oe(y.value,a=>(p(),f(O,{key:a.id,label:a.role_name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t.id?(p(),f(r,{key:1,label:"状态"},{default:o(()=>[e(z,{modelValue:t.status,"onUpdate:modelValue":l[6]||(l[6]=a=>t.status=a),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1})):D("",!0)]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},pe=Y(re,[["__scopeId","data-v-ced48b91"]]);export{pe as default};
